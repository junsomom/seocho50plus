<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>그림 동화책 창작 지침서 - 감정과 관계 (FIXED)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap');
    body { font-family: 'Nanum Gothic', 'Arial', sans-serif; }
    input, textarea, select, button { font-family: inherit; }
    .font-bold option:checked { font-weight: 700; }
  </style>
</head>
<body class="bg-orange-50 text-stone-800">
  <div class="container mx-auto max-w-4xl p-4 sm:p-8">
    <header class="text-center mb-10">
      <h1 class="text-4xl sm:text-5xl font-bold text-orange-800">🌳 감정과 관계를 위한 그림 동화책 창작 지침서</h1>
    </header>

    <div class="guide-box bg-white/80 border-l-4 border-orange-600 p-6 rounded-lg shadow-md mb-12">
      <p class="text-lg"><strong>이 그림책의 목표는</strong> ‘<strong>관계의 소중한 감정</strong>’을 가지고 자연과 이웃들과 관계하며 살아가는 인생의 중요성을 <strong>쉽게 이해하고 공감할 수 있도록</strong> 하는 것입니다. 이 목표를 마음에 두고 이야기를 창작해 주세요.</p>
    </div>

    <!-- Steps 1 ~ 5 (unchanged structure) -->
    <!-- ... 기존 입력 폼 코드는 그대로 유지 ... -->

    <div class="text-center mt-12">
      <button id="generateBtn" type="button" class="w-full sm:w-auto bg-gradient-to-br from-orange-500 to-red-500 text-white text-xl font-bold py-4 px-12 rounded-lg shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
        AI 명령어 만들기
      </button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // 예시 버튼 처리
      document.querySelectorAll('.use-example-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const targetId = btn.dataset.target;
          const targetInput = document.getElementById(targetId);
          if (!targetInput) return;
          if (targetInput.tagName.toLowerCase() === 'select') {
            targetInput.classList.add('font-bold');
          } else {
            targetInput.value = targetInput.placeholder || targetInput.value;
            targetInput.classList.add('font-bold');
          }
        });
      });

      // 입력 시 bold 처리
      document.querySelectorAll('textarea, input, select').forEach(input => {
        input.addEventListener('input', () => {
          input.classList.toggle('font-bold', input.value.trim() !== '');
        });
      });

      // 버튼 클릭 시 팝업 열기
      document.getElementById('generateBtn').addEventListener('click', () => {
        const getValue = (id) => {
          const el = document.getElementById(id);
          return el && el.value.trim() ? el.value.trim() : '(내용 없음)';
        };

        const values = {
          topic: getValue('topic'),
          title: getValue('title-input'),
          protagonistSynopsis: getValue('protagonist-synopsis'),
          problem: getValue('problem'),
          solution: getValue('solution'),
          lesson: getValue('lesson'),
          characterMain: getValue('character-main'),
          characterFriend1: getValue('character-friend1'),
          characterFriend2: getValue('character-friend2'),
          characterAntagonist: getValue('character-antagonist'),
          scene1: getValue('scene1'),
          scene2: getValue('scene2'),
          scene3: getValue('scene3'),
          scene4: getValue('scene4'),
          scene5: getValue('scene5'),
          imageStyle: getValue('image-style'),
        };

        const promptText = `\n[그림 동화책 창작 지침서 - 감정과 관계]\n\n---\n\n### Step 1. 주제\n${values.topic}\n\n### Step 2. 시놉시스\n- 제목: ${values.title}\n- 주인공: ${values.protagonistSynopsis}\n- 문제 상황: ${values.problem}\n- 해결 방법: ${values.solution}\n- 교훈: ${values.lesson}\n\n### Step 3. 등장인물\n- 주인공: ${values.characterMain}\n- 친구1: ${values.characterFriend1}\n- 친구2: ${values.characterFriend2}\n- 문제 유발자: ${values.characterAntagonist}\n\n### Step 4. 장면 구성\n1) ${values.scene1}\n2) ${values.scene2}\n3) ${values.scene3}\n4) ${values.scene4}\n5) ${values.scene5}\n\n### Step 5. 이미지 스타일\n${values.imageStyle}\n\n---\n\n위 내용을 바탕으로 따뜻하고 감동적인 그림 동화책을 만들어 줘.`;

        const popupHtml = `<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><title>AI 동화책 명령어</title><script src="https://cdn.tailwindcss.com"></script></head><body class="bg-gray-100 font-sans p-8"><div class="container mx-auto max-w-4xl bg-white p-8 rounded-lg shadow-lg"><h1 class="text-3xl font-bold mb-4 text-gray-800">생성된 AI 명령어</h1><p class="text-gray-600 mb-6">아래 내용을 복사해서 Gemini 같은 AI에 붙여넣으세요.</p><button id="copyBtn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg mb-6 hover:bg-blue-700 transition-colors">전체 내용 복사하기</button><pre id="prompt-text" class="bg-gray-50 p-6 rounded-md whitespace-pre-wrap text-left text-gray-800 text-base leading-relaxed border border-gray-200"></pre></div><script>const text=${JSON.stringify(promptText)};document.getElementById('prompt-text').textContent=text;document.getElementById('copyBtn').addEventListener('click',()=>{navigator.clipboard.writeText(text).then(()=>{const btn=document.getElementById('copyBtn');btn.textContent='✅ 복사 완료!';btn.classList.remove('bg-blue-600','hover:bg-blue-700');btn.classList.add('bg-green-600');setTimeout(()=>{btn.textContent='전체 내용 복사하기';btn.classList.remove('bg-green-600');btn.classList.add('bg-blue-600','hover:bg-blue-700');},2000);}).catch(()=>{alert('자동 복사 실패. 직접 복사하세요.');});});<\/script></body></html>`;

        const newWindow = window.open('', 'aiPromptWindow', 'width=800,height=600');
        if (newWindow) {
          newWindow.document.open();
          newWindow.document.write(popupHtml);
          newWindow.document.close();
        } else {
          alert('팝업이 차단되었습니다. 브라우저 팝업 차단을 해제하세요.');
        }
      });
    });
  </script>
</body>
</html>
